<!DOCTYPE html>
<html>
<head>
    <title>Humble Pi</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
    <script src="plotly-latest.min.js"></script>
</head>
<body>

    <h1>Humble Pi</h1>
    <h2> Number of points placed </h3>
    <p id="n">0</p>
    <h2> Current estimate of Pi </h3>
    <p>(Equal to 4 times the number of points inside the circle, divided by total number of points)</p>
    <p id="pi">0</p>

    <h2> Speed </h3>
    <button class="btn btn-primary" onclick="SloowFunction()">Sloooow</button>
    <button class="btn btn-primary" onclick="SlowFunction()">Slow</button>
    <button class="btn btn-primary" onclick="FastFunction()">Fast</button>
    <button class="btn btn-primary" onclick="FaastFunction()">ZOOOOOM</button>

    <div class="row">
        <div class="col-6">
            <div id="ScatterPlot" style="width:600px;height:600px;"></div>
        </div>
        <div class="col-6">
            <div id="LinePlot" style="width:600px;height:600px;"></div>
        </div>
    </div>


</body>
</html>

<script>
function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

var n = 100;
var x = [], y = [];
var x_line = [], y_line = [];
var inside = 0, total = 0;
var i = 0;
var dt = 0.015;
var delay = 1000;

function SloowFunction() {
    delay = 1000;
}
function SlowFunction() {
    delay = 400;
}
function FastFunction() {
    delay = 100;
}
function FaastFunction() {
    delay = 1;
}


Plotly.newPlot('ScatterPlot', [{
    x: x,
    y: y,
    mode: 'markers'
}], {
    xaxis: {range: [-1.02, 1.02]},
    yaxis: {range: [-1.02, 1.02]},
    shapes: [
    {
        type: 'circle',
        xref: 'x',
        yref: 'y',
        x0: -1,
        y0: -1,
        x1: 1,
        y1: 1,
        line: {
            color: 'rgba(171, 50, 96, 1)'
        }
    },
    ]
})

Plotly.newPlot('LinePlot', [{
  x: x_line,
  y: y_line,
}], {
    xaxis: {range: [0, 1]},
    yaxis: {range: [2, 4.1]},
    shapes: [
    {
        type: 'line',
        x0: 0,
        y0: 3.14,
        x1: 10000,
        y1: 3.14,
        line:{
            color: 'rgb(255, 0, 0)',
            width: 4,
            dash:'dot'
        }
    }
    ]
}
)

function compute () {
    x[i] = Math.random()*2-1;
    y[i] = Math.random()*2-1;
    total = total + 1;
    if(x[i]*x[i] + y[i]*y[i] < 1){
        inside = inside + 1;
    }
    x_line[i] = i;
    y_line[i] = 4*inside/total;
    i = i + 1;
    document.getElementById("pi").innerHTML = 4*inside/total;
    document.getElementById("n").innerHTML = total;
}

async function update () {
    await sleep(delay);
    compute();

  Plotly.animate('ScatterPlot', {
    data: [{x: x, y: y}],
    },
    {
    transition: {
        duration: 0
    },
    frame: {
        duration: 0,
        redraw: false
    },
    });
  
  Plotly.animate('LinePlot', {
    data: [{x: x_line, y: y_line}],
    layout: {
        xaxis: {range: [0, i+1]},
        yaxis: {range: [2, 4.1]},
    }
    },
    {
    transition: {
        duration: 0
    },
    frame: {
        duration: 0,
        redraw: false
    },
    });

  requestAnimationFrame(update);
}
requestAnimationFrame(update);

</script>